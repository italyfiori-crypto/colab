<!--home页面-->
<view class="home-container">
  <!-- 搜索栏 -->
  <view class="search-container">
    <view class="search-bar">
      <icon class="search-icon" type="search" size="16" color="#999"></icon>
      <input 
        class="search-input" 
        placeholder="搜索书籍或文章..." 
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
        confirm-type="search"
        bindconfirm="onSearchConfirm"
      />
    </view>
  </view>

  <!-- 搜索结果 -->
  <view class="section search-results-section" wx:if="{{showSearchResults}}">
    <view class="section-header">
      <text class="section-title">搜索结果 ({{searchResults.length}})</text>
    </view>
    
    <!-- 搜索结果网格 -->
    <view class="search-results-grid" wx:if="{{searchResults.length > 0}}">
      <view 
        wx:for="{{searchResults}}" 
        wx:key="_id"
        class="search-book-item"
        bindtap="onBookTap"
        data-book-id="{{item._id}}"
        data-book="{{item}}"
      >
        <view class="search-book-cover-wrapper">
          <image class="search-book-cover" src="{{item.cover_url}}" mode="aspectFill" lazy-load="true" binderror="onBookCoverError" data-index="{{index}}"></image>
        </view>
        <view class="search-book-info">
          <text class="search-book-title">{{item.title}}</text>
          <text class="search-book-author">{{item.author}}</text>
        </view>
      </view>
    </view>
    
    <!-- 空搜索结果 -->
    <view class="empty-search-results" wx:if="{{searchResults.length === 0 && !searchLoading}}">
      <text class="empty-text">未找到相关书籍</text>
    </view>
  </view>

  <!-- 最近学习 -->
  <view class="section recent-section" wx:if="{{!showSearchResults && recentBooks && recentBooks.length > 0}}">
    <view class="section-header">
      <text class="section-title">最近学习</text>
    </view>
    
    <scroll-view class="books-scroll" scroll-x="true" show-scrollbar="false">
      <view class="books-list">
        <view 
          wx:for="{{recentBooks}}" 
          wx:key="_id" 
          class="book-card"
          bindtap="onBookTap"
          data-book-id="{{item._id}}"
          data-book="{{item}}"
        >
          <view class="book-cover-wrapper">
            <image class="book-cover" src="{{item.cover_url}}" mode="aspectFill" lazy-load="true" binderror="onBookCoverError" data-index="{{index}}"></image>
          </view>
          <view class="book-info">
            <text class="book-title">{{item.title}}</text>
            <text class="book-author">{{item.author}}</text>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- 分类书籍 -->
  <view class="section category-section" wx:if="{{!showSearchResults}}">
    <view class="section-header">
      <text class="section-title">书籍列表</text>
    </view>
    
    <!-- 分类标签 -->
    <scroll-view class="category-tabs-scroll" scroll-x="true" show-scrollbar="false">
      <view class="category-tabs">
        <view 
          wx:for="{{categories}}" 
          wx:key="name"
          class="category-tab {{item.active ? 'active' : ''}}"
          bindtap="onCategoryTap"
          data-category="{{item.name}}"
        >
          {{item.name}}
        </view>
      </view>
    </scroll-view>
    
    <!-- 书籍网格 -->
    <view class="books-grid">
      <view 
        wx:for="{{currentCategoryBooks}}" 
        wx:key="_id"
        class="book-grid-item"
        bindtap="onBookTap"
        data-book-id="{{item._id}}"
        data-book="{{item}}"
      >
        <view class="book-cover-wrapper">
          <image class="book-cover" src="{{item.cover_url}}" mode="aspectFill" lazy-load="true"></image>
        </view>
        <view class="book-info">
          <text class="book-title">{{item.title}}</text>
          <text class="book-author">{{item.author}}</text>
        </view>
      </view>
    </view>
  </view>
</view>

