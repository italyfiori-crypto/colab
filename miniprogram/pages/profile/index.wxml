<!-- è®¾ç½®é¡µé¢ -->
<view class="settings-container">
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="user-card">
    <view class="user-avatar" bindtap="onEditAvatar">
      <image class="avatar-image" src="{{userInfo.avatarUrl}}" mode="aspectFill" binderror="onAvatarLoadError"></image>
      <view class="avatar-edit-icon">ğŸ“·</view>
    </view>
    <view class="user-info">
      <view class="user-name-section" bindtap="onEditNickname">
        <text class="user-name">{{userInfo.nickName}}</text>
        <text class="edit-icon">âœï¸</text>
      </view>
      <text class="user-id">ID: {{userInfo.userId || 'æœªè®¾ç½®'}}</text>
    </view>
  </view>

  <!-- ä¼šå‘˜ä¿¡æ¯å¡ç‰‡ -->
  <view class="membership-card">
    <view class="membership-header">
      <text class="membership-icon">{{membershipInfo.is_premium ? 'ğŸ’' : 'ğŸ”“'}}</text>
      <view class="membership-info">
        <text class="membership-status">{{membershipInfo.is_premium ? 'ä¼šå‘˜ç”¨æˆ·' : 'å…è´¹ç”¨æˆ·'}}</text>
        <text class="membership-desc" wx:if="{{membershipInfo.is_premium && membershipInfo.days_remaining > 0}}">
          è¿˜æœ‰{{membershipInfo.days_remaining}}å¤©åˆ°æœŸ
        </text>
        <text class="membership-desc" wx:elif="{{!membershipInfo.is_premium}}">
          å‡çº§ä¼šå‘˜äº«å—å®Œæ•´å†…å®¹
        </text>
        <text class="membership-desc" wx:else>ä¼šå‘˜å·²è¿‡æœŸ</text>
      </view>
      <view class="membership-action" bindtap="onMembershipAction">
        <text class="action-text">{{membershipInfo.is_premium ? 'ç»­è´¹' : 'æ¿€æ´»'}}</text>
      </view>
    </view>
    <view class="membership-benefits" wx:if="{{!membershipInfo.is_premium}}">
      <view class="benefit-item">
        <text class="benefit-icon">ğŸ“š</text>
        <text class="benefit-text">è§£é”æ‰€æœ‰ä¹¦ç±ç« èŠ‚</text>
      </view>
      <view class="benefit-item">
        <text class="benefit-icon">ğŸ§</text>
        <text class="benefit-text">é«˜è´¨é‡éŸ³é¢‘å†…å®¹</text>
      </view>
      <view class="benefit-item">
        <text class="benefit-icon">ğŸ“Š</text>
        <text class="benefit-text">è¯¦ç»†å­¦ä¹ ç»Ÿè®¡</text>
      </view>
    </view>
  </view>

  <!-- é˜…è¯»è®¾ç½® -->
  <view class="settings-section">
    <view class="settings-list">
      <!-- å­—å¹•è¯­è¨€ -->
      <view class="setting-item" bindtap="onSelectSubtitleLang">
        <view class="setting-left">
          <text class="setting-icon">ğŸŒ</text>
          <text class="setting-label">å­—å¹•è¯­è¨€</text>
        </view>
        <view class="setting-right">
          <text class="setting-value">{{readingSettings.subtitleLang}}</text>
        </view>
      </view>
      
      <!-- æ’­æ”¾é€Ÿåº¦ -->
      <view class="setting-item" bindtap="onSelectPlaybackSpeed">
        <view class="setting-left">
          <text class="setting-icon">â±ï¸</text>
          <text class="setting-label">æ’­æ”¾é€Ÿåº¦</text>
        </view>
        <view class="setting-right">
          <text class="setting-value">{{readingSettings.playbackSpeed}}x</text>
        </view>
      </view>
      
    </view>
  </view>

  <!-- å­¦ä¹ è®¾ç½® -->
  <view class="settings-section">
    <view class="settings-list">
      <!-- è¯­éŸ³ç±»å‹ -->
      <view class="setting-item" bindtap="onSelectVoiceType">
        <view class="setting-left">
          <text class="setting-icon">ğŸ”Š</text>
          <text class="setting-label">è¯­éŸ³ç±»å‹</text>
        </view>
        <view class="setting-right">
          <text class="setting-value">{{learningSettings.voiceType}}</text>
        </view>
      </view>
      
      <!-- æ¯æ—¥æ–°å­¦ä¸Šé™ -->
      <view class="setting-item" bindtap="onSetDailyWordLimit">
        <view class="setting-left">
          <text class="setting-icon">ğŸ“š</text>
          <text class="setting-label">æ¯æ—¥æ–°å­¦ä¸Šé™</text>
        </view>
        <view class="setting-right">
          <text class="setting-value">{{learningSettings.dailyWordLimit}}ä¸ª</text>
        </view>
      </view>
      
      <!-- æ–°å­¦å•è¯æ’åº -->
      <view class="setting-item" bindtap="onSelectNewWordSort">
        <view class="setting-left">
          <text class="setting-icon">ğŸ”„</text>
          <text class="setting-label">æ–°å­¦å•è¯æ’åº</text>
        </view>
        <view class="setting-right">
          <text class="setting-value">{{learningSettings.newWordSort}}</text>
        </view>
      </view>
      
    </view>
  </view>

  <!-- å…¶ä»–è®¾ç½® -->
  <view class="settings-section">
    <view class="settings-list">
      <!-- å¸®åŠ© -->
      <view class="setting-item" bindtap="onShowHelp">
        <view class="setting-left">
          <text class="setting-icon">â“</text>
          <text class="setting-label">å¸®åŠ©</text>
        </view>
        <view class="setting-right">
        </view>
      </view>
      
      <!-- æ„è§åé¦ˆ -->
      <view class="setting-item" bindtap="onFeedback">
        <view class="setting-left">
          <text class="setting-icon">ğŸ’¬</text>
          <text class="setting-label">æ„è§åé¦ˆ</text>
        </view>
        <view class="setting-right">
        </view>
      </view>
      
      <!-- ç‰ˆæœ¬ä¿¡æ¯ -->
      <view class="setting-item">
        <view class="setting-left">
          <text class="setting-icon">â„¹ï¸</text>
          <text class="setting-label">ç‰ˆæœ¬ä¿¡æ¯</text>
        </view>
        <view class="setting-right">
          <text class="setting-value">v1.0.0</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ä¼šå‘˜ç è¾“å…¥å¼¹çª— -->
  <view class="membership-modal-overlay" wx:if="{{showMembershipModal}}" bindtap="onCloseMembershipModal">
    <view class="membership-modal" catchtap="">
      <view class="modal-header">
        <text class="modal-title">æ¿€æ´»ä¼šå‘˜ç </text>
        <text class="modal-close" bindtap="onCloseMembershipModal">âœ•</text>
      </view>
      <view class="modal-content">
        <view class="input-section">
          <text class="input-label">è¯·è¾“å…¥12ä½ä¼šå‘˜ç </text>
          <input class="code-input" 
                 placeholder="è¯·è¾“å…¥ä¼šå‘˜ç " 
                 value="{{codeInput}}"
                 bindinput="onCodeInput"
                 maxlength="12"
                 auto-focus="{{showMembershipModal}}"/>
        </view>
        <view class="modal-tips">
          <text class="tip-text">â€¢ ä¼šå‘˜ç ä¸åŒºåˆ†å¤§å°å†™</text>
          <text class="tip-text">â€¢ æ¿€æ´»åç«‹å³ç”Ÿæ•ˆ</text>
          <text class="tip-text">â€¢ å¯å åŠ ä½¿ç”¨å»¶é•¿æœ‰æ•ˆæœŸ</text>
        </view>
      </view>
      <view class="modal-actions">
        <button class="cancel-btn" bindtap="onCloseMembershipModal">å–æ¶ˆ</button>
        <button class="confirm-btn" 
                bindtap="onActivateCode" 
                disabled="{{activating || codeInput.length !== 12}}"
                loading="{{activating}}">
          {{activating ? 'æ¿€æ´»ä¸­...' : 'æ¿€æ´»'}}
        </button>
      </view>
    </view>
  </view>
</view>