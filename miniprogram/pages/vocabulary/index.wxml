<!--vocabulary单词本页面-->
<view class="vocabulary-container">

  <!-- 主要内容区域 -->
  <view class="main-content">
    <!-- 单词列表 -->
    <view class="word-list">
      <view 
        wx:for="{{words}}" 
        wx:key="id"
        class="word-item {{wordType}} {{item.isLearned ? 'learned' : ''}} {{item.isReviewed ? 'reviewed' : ''}} {{item.isExpanded ? 'expanded' : ''}}"
        data-word="{{item}}"
        data-index="{{index}}"
        bindtap="{{wordType === 'overdue' ? 'onToggleExpand' : 'onWordTap'}}"
        bindtouchstart="{{wordType === 'review' ? 'onTouchStart' : ''}}"
        bindtouchmove="{{wordType === 'review' ? 'onTouchMove' : ''}}"
        bindtouchend="{{wordType === 'review' ? 'onTouchEnd' : ''}}"
      >
        <!-- 外层序号容器 -->
        <view class="word-number-container {{item.isLearned ? 'learned-bg' : ''}} {{item.isReviewed ? 'reviewed-bg' : ''}}">
          <view class="word-number">{{index + 1}}</view>
        </view>
        
        <!-- 内容区域容器 -->  
        <view class="word-content">
          <!-- 单词信息 -->
          <view class="word-main {{displayMode === 'english-mask' ? 'has-mask' : ''}}">
            <view class="word-header">
              <view class="word-text">{{item.word}}</view>
              <!-- 逾期标识 -->
              <view wx:if="{{wordType === 'overdue' && item.overdue_days}}" class="overdue-badge">
                逾期{{item.overdue_days}}天
              </view>
            </view>
            <view class="word-phonetic">{{item.phonetic}}</view>
            <!-- 英文遮罩覆盖层 -->
            <view wx:if="{{displayMode === 'english-mask' && !item.isExpanded}}" class="english-mask-overlay" bindtap="onToggleMask" data-index="{{index}}">
              <text class="mask-text">点击显示</text>
            </view>
          </view>
          
          <!-- 翻译区域 -->
          <view class="word-translation">
            <view class="translation-content">
              <view wx:for="{{item.translations}}" wx:key="*this" class="translation-item">
                <text class="part-of-speech">{{item.partOfSpeech}}</text>
                <view class="meaning-container">
                  <text class="meaning">{{item.meaning}}</text>
                  <!-- 中文遮罩覆盖层 -->
                  <view wx:if="{{displayMode === 'chinese-mask' && !item.isExpanded}}" class="chinese-mask-overlay" bindtap="onToggleMask" data-index="{{index}}">
                    <text class="mask-text">点击显示</text>
                  </view>
                </view>
              </view>
            </view>
          </view>
        </view>
        
        <!-- 逾期单词处理按钮 -->
        <view wx:if="{{wordType === 'overdue' && item.isExpanded}}" class="overdue-actions">
          <view class="overdue-btn remember-btn" bindtap="onHandleOverdue" data-index="{{index}}" data-action="remember">
            还记得
          </view>
          <view class="overdue-btn vague-btn" bindtap="onHandleOverdue" data-index="{{index}}" data-action="vague">
            模糊
          </view>
          <view class="overdue-btn forgot-btn" bindtap="onHandleOverdue" data-index="{{index}}" data-action="forgot">
            忘记了
          </view>
        </view>
        
        <!-- 复习单词滑动操作按钮 -->
        <view class="slide-actions" wx:if="{{wordType === 'review' && item.showActions}}">
          <view class="action-btn forgot" bindtap="onReviewWord" data-index="{{index}}" data-action="forgot">
            <text class="action-text">忘记了</text>
          </view>
          <view class="action-btn mastered" bindtap="onReviewWord" data-index="{{index}}" data-action="mastered">
            <text class="action-text">记牢了</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 空状态提示 -->
    <view wx:if="{{!loading && words.length === 0}}" class="empty-state">
      <view class="empty-icon">
        <text wx:if="{{wordType === 'new'}}">📚</text>
        <text wx:elif="{{wordType === 'review'}}">🔄</text>
        <text wx:else="{{wordType === 'overdue'}}">✅</text>
      </view>
      <view class="empty-title">
        <text wx:if="{{wordType === 'new'}}">暂无待学习单词</text>
        <text wx:elif="{{wordType === 'review'}}">暂无需要复习的单词</text>
        <text wx:else="{{wordType === 'overdue'}}">暂无逾期单词，继续加油！</text>
      </view>
      <view class="empty-subtitle">
        <text wx:if="{{wordType === 'new'}}">完成章节学习后会出现新单词</text>
        <text wx:elif="{{wordType === 'review'}}">按时复习，保持学习节奏</text>
        <text wx:else="{{wordType === 'overdue'}}">坚持复习，避免单词逾期</text>
      </view>
    </view>

    <!-- 加载状态 -->
    <view wx:if="{{loading}}" class="loading-state">
      <text class="loading-text">正在加载单词...</text>
    </view>
  </view>
  
  <!-- 设置弹窗 -->
  <view class="settings-modal" wx:if="{{showSettings}}" bindtap="onHideSettings">
    <view class="modal-content" catchtap="">
      <view class="modal-header">
        <text class="modal-title">显示设置</text>
        <view class="modal-close" bindtap="onHideSettings">×</view>
      </view>
      <view class="modal-body">
        <view class="setting-item {{displayMode === 'both' ? 'active' : ''}}" bindtap="onChangeDisplayMode" data-mode="both">
          <text class="setting-text">中英</text>
          <view class="setting-desc">同时显示英文和中文</view>
        </view>
        <view class="setting-item {{displayMode === 'chinese-mask' ? 'active' : ''}}" bindtap="onChangeDisplayMode" data-mode="chinese-mask">
          <text class="setting-text">中文遮罩</text>
          <view class="setting-desc">隐藏中文翻译，点击显示</view>
        </view>
        <view class="setting-item {{displayMode === 'english-mask' ? 'active' : ''}}" bindtap="onChangeDisplayMode" data-mode="english-mask">
          <text class="setting-text">英文遮罩</text>
          <view class="setting-desc">隐藏英文单词，点击显示</view>
        </view>
      </view>
    </view>
  </view>

</view>